#!/usr/bin/env python3

"""
go run . ../../../data/aug-4/cn/tls/tls.pcap.gz | sort -n | uniq -c
"""
import plotly.graph_objects as go

def main():
	counts = {
		"tls":[57000 , 38076 , 366669 , 37742 , 7968 , 16748 , 5251 , 1365 , 1020 , 1091 , 289 , 547 , 71 , 137 , 265 , 38 , 86 , 53 , 48 , 47 , 42 , 79 , 24 , 10 , 13 , 19 , 18 , 3 , 4 , 1 , 2 , 3 , 1 , 2 , 1 , 1 , 1],
		"http":[162219 , 505132 , 271135 , 55002 , 51729 , 25776 , 8226 , 4580 , 4059 , 1339 , 1521 , 714 , 549 , 167 , 487 , 193 , 163 , 75 , 107 , 78 , 132 , 62 , 35 , 28 , 30 , 50 , 20 , 14 , 10 , 11 , 12 , 7 , 8 , 8 , 7 , 14 , 7 , 2 , 6 , 2 , 2 , 1 , 4 , 1 , 1 , 3 , 1 , 1 , 1],
		"tls-nsa":[215974, 28204, 5998, 3492, 1189, 424, 18, 216, 82, 142, 14, 49, 107, 10, 9, 8, 7, 2, 5, 3, 2, 2, 1, 1, 1, 1],
		"http-nsa":[218318 , 53973 , 15234 , 6015 , 1636 , 1413 , 54 , 586 , 173 , 389 , 21 , 101 , 19 , 12 , 76 , 16 , 3 , 1 , 12 , 2]
	}
	nprobes = {
		"tls":[1 , 2 , 3 , 4 , 5 , 6 , 7 , 8 , 9 , 10 , 11 , 12 , 13 , 14 , 15 , 16 , 17 , 18 , 19 , 20 , 21 , 22 , 23 , 24 , 25 , 26 , 27 , 28 , 29 , 30 , 31 , 32 , 36 , 37 , 38 , 41 , 52],
		"http":[1 , 2 , 3 , 4 , 5 , 6 , 7 , 8 , 9 , 10 , 11 , 12 , 13 , 14 , 15 , 16 , 17 , 18 , 19 , 20 , 21 , 22 , 23 , 24 , 25 , 26 , 27 , 28 , 29 , 30 , 31 , 32 , 33 , 34 , 35 , 36 , 37 , 38 , 39 , 40 , 41 , 42 , 45 , 47 , 48 , 51 , 52 , 53 , 59],
		"tls-nsa":[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 18, 19, 20, 22, 23, 26, 27, 37, 41, 44],
		"http-nsa":[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 20, 25]
	}

	bars = []
	for key, count in counts.items():
		bars.append(go.Bar(x=nprobes[key], y=count, name = key))

	fig = go.Figure(bars)
	fig.update_yaxes(type="log")
	fig.show()


if __name__ == "__main__":
	main()


"""
TLS

57000 1
38076 2
366669 3
37742 4
7968 5
16748 6
5251 7
1365 8
1020 9
1091 10
289 11
547 12
71 13
137 14
265 15
38 16
86 17
53 18
48 19
47 20
42 21
79 22
24 23
10 24
13 25
19 26
18 27
3 28
4 29
1 30
2 31
3 32
1 36
2 37
1 38
1 41
1 52

HTTP

162219 1
505132 2
271135 3
55002 4
51729 5
25776 6
8226 7
4580 8
4059 9
1339 10
1521 11
714 12
549 13
167 14
487 15
193 16
163 17
75 18
107 19
78 20
132 21
62 22
35 23
28 24
30 25
50 26
20 27
14 28
10 29
11 30
12 31
7 32
8 33
8 34
7 35
14 36
7 37
2 38
6 39
2 40
2 41
1 42
4 45
1 47
1 48
3 51
1 52
1 53
1 59

HTTP-NSA
218318 1
53973 2
15234 3
6015 4
1636 5
1413 6
54 7
586 8
173 9
389 10
21 11
101 12
19 13
12 14
76 15
16 16
3 17
1 18
12 20
2 25

TLS-NSA
215974 1
28204 2
5998 3
3492 4
1189 5
424 6
18 7
216 8
82 9
142 10
14 11
49 12
107 13
10 14
9 15
8 16
7 18
2 19
5 20
3 22
2 23
2 26
1 27
1 37
1 41
1 44
"""
